<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>混雑更新</title>

<style>
body{
  font-family: sans-serif;
  text-align:center;
  background:#f5f5f5;
}

button{
  font-size:24px;
  padding:15px 25px;
  margin:10px;
}
</style>
</head>

<body>

<h1>混雑状況 更新</h1>

<select id="classSelect"></select>

<br><br>

<button onclick="setStatus('○')">○ 空き</button>
<button onclick="setStatus('△')">△ 普通</button>
<button onclick="setStatus('×')">× 混雑</button>

<p id="msg"></p>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDTHN-YfAJz86NgNAaldixubGfDZwRgnKw",
  authDomain: "bunkasai-info-59212.firebaseapp.com",
  databaseURL: "https://bunkasai-info-59212-default-rtdb.firebaseio.com",
  projectId: "bunkasai-info-59212",
  storageBucket: "bunkasai-info-59212.firebasestorage.app",
  messagingSenderId: "775251011941",
  appId: "1:775251011941:web:7237a990162fa00217198c"
};

firebase.initializeApp(firebaseConfig);

const db = firebase.database();

// クラス一覧読み込み
db.ref("classes").once("value", snap=>{
  const data = snap.val();
  const sel = document.getElementById("classSelect");

  for(let k in data){
    const opt = document.createElement("option");
    opt.value = k;
    opt.textContent = data[k].name;
    sel.appendChild(opt);
  }
});

// 状態更新
function setStatus(s){
  const c = classSelect.value;

  db.ref("classes/"+c+"/status").set(s);

  msg.innerText="更新しました！";
}
</script>

</body>
</html>

